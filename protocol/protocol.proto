syntax = "proto3";

import "code.proto";
import "status.proto";

option go_package = "github.com/potix/ylcc/protocol";

// The ylcc service definition.
service ylcc {
	// Get video information 
	rpc GetVideoInfo (GetVideoInfoRequst) returns (GetVideoInfoResponse) {}
	// Start collect video
	rpc StartCollectLiveChat (StartCollectLiveChatRequest) returns (StartCollectLiveChatResponse) {}
	// Delete live Chat
	rpc DeleteLiveChat (DeleteLiveChatRequest) returns (DeleteLiveChatResponse) {}
	// Get recently active live chat of video
	rpc GetRecentlyActiveLiveChat (GetRecentlyActiveLiveChatRequest) returns (GetRecentlyActiveLiveChatResponse) {}
	// Get live chat of video
	rpc GetLiveChat (GetLiveChatRequest) returns (stream GetLiveChatResponse) {}
}

message GetVideoInfoRequst {
	string videoId = 1;
}

message GetVideoInfoResponse {
	google.rpc.Status status = 1;
	VidepInfo videoInfo = 2;
}

message StartCollectLiveChatRequest {
	string videoId = 1;
}

message StartCollectLiveChatResponse {
	google.rpc.Status status = 1;
	VidepInfo videoInfo = 2;
}

message VidepInfo {
	string videoId = 1;
	string channelId = 2;
	string categoryId = 3; 
	string title = 4;  
	string description = 5;
	string publishedAt = 6;
	string duration = 7;
	string activeLiveChatId = 8;
        string actualStartTime = 9;
        string actualEndTime = 10;
        string scheduledStartTime = 11;
        string scheduledEndTime = 12; 
        string statusPrivacyStatus = 13;
	string statusUploadStatus = 14;
	string statusEmbeddable = 15;
}

message DeleteLiveChatRequest {
	string videoId = 1;
}

message DeleteLiveChatResponse {
	google.rpc.Status status = 1;
	string errorMessage = 2;
}

message GetRecentlyActiveLiveChatRequest {
	string videoId = 1;
	uint32 maxMessages = 2;
}

message GetRecentlyActiveLiveChatResponse {
	google.rpc.Status status = 1;
	repeated ActiveLiveChatMessage activeLiveChatMessages = 2;
}

message ActiveLiveChatMessage {
	string messageId = 1;
        string channelId = 2;
        string videoId = 3;
	string liveChatMessageListResponseEtag = 4;
	string authorChannelId = 5;
	string authorChannelUrl = 6;
	string authorDisplayName = 7;
	string authorProfileImageUrl = 8;
	string authorIsChatModerator = 9;
	string authorIsChatOwner = 10;
	string authorIsChatSponsor = 11;
	string authorIsVerified = 12;
	string liveChatId = 13;
	string displayMessage = 14;
	string messagePublishedAt = 15;
	bool isSuperChat = 16;
	string amountDisplayString = 17;
	string currency = 18;
}

message GetLiveChatRequest {
	string videoId = 1;
	uint32 maxBulkMessages = 2;
}

message GetLiveChatResponse {
	google.rpc.Status status = 1;
	repeated LiveChatMessage liveChatMessage  = 2;
}

message LiveChatMessage {
        string messageId = 1;
        string channelId = 2;
        string videoId = 3;
        string timestampUsec = 4;
        string clientId  = 5;
        string authorName = 6;
        string authorPhotoUrlThumbnails = 7;
        string messageText = 8;
        string purchaseAmountText = 9;
        string videoOffsetTimeMsec = 10;
}





